# Python环境配置

## 概述
这个仓库是我用于管理多台设备上Python虚拟环境的配置文件集合。我的目标是通过**声明式**的方式，实现跨设备环境的统一和高效管理。

**约定的做法是:** 每当环境配置发生变化时，只修改相应的配置文件，然后销毁并重建整个环境。以此，确保所有设备上的环境完全一致。


## 管理方法
多种工具来管理不同的环境，每种工具都有其独特的优势和适用场景: 
- **pip:** 基于requirements.txt文件。最基础和通用的，需要结合venv，不是最好的。
- **conda:** 基于environment.yaml文件。在数据科学领域占据主导地位，能够彻底隔离环境，方便复用，但速度较慢。
- **uv:** 基于pyproject.toml文件。最新的工具，速度快且好用。社区近期有2个标志，pytorch放弃了conda，vllm使用uv。
- **shell:** 脚本安装。最彻底的管理。常见场景为git源码安装并进行设置。

## 通用基础环境
我预构建了我常见任务的基础环境，包括: 
- **agent_env:** 用于开发agent的基础环境，当前配置以langchain和langgraph为核心。
- **dl_env:** 深度学习任务基础环境。具体进行模型设计和训练。
- **ds_env:** 数据科学研究基础环境。数据分析和可视化常用环境。
- **llm_env:** 运行、部署和训练LLM的基础环境。
- **spider_env:** 爬虫开发专用环境。
- **web_env:** 后端开发基础环境。

当然，这个仓库中已有的配置文件远不止于此，你可以在`specific_projects`中查看。


## 如何使用
以下为基于`conda`配置的示例，主要原因是conda在科学计算的影响过于久远。但我在未来有计划迁移至`uv`和`pixi`。

### 检查已有环境
首先，检查已经存在的虚拟环境。
```shell
conda env list
```

### 重构环境
如果旧环境存在的话，移除它。
```shell
conda deactivate
conda remove --name ${env_name} --all
```
重建环境。
新环境通过配置文件构建。
```shell
conda env create -f ./environment.yaml
```

### 检查安装的包
最后，检查依赖是否已在环境中。
```shell
conda activate ${env_name}
conda list
```

这些命令可以在 `run.sh` 文件中查看。 

## 更多
我计划在现有基础上进一步扩展这个仓库，纳入更先进和全面的环境管理方案:
- **新一代的工具:** 包括`uv`、`pixi`。目前，为了科研任务的兼容性考虑，我依然主要使用conda。但在个人项目，我会使用新的工具。
- **docker:** 以docker部署开发环境是最彻底的。目前没有这么做的原因是:
  - 本地docker对资源的需求较高。
  - 公用服务器可能缺乏权限或条件。

